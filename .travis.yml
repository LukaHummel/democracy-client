# environment setup
language: swift
osx_image: xcode11.1

cache: yarn

before_install:
  - nvm install 10
  - node --version
  - travis_retry npm install -g yarn
  - yarn -version

install:
  - yarn && yarn pods
  - cd packages/mobile-app/ios
  - bundle install
jobs:
  include:
    - stage: Deploy
      name: Deploy to App Store
      script:
        - echo "machine github.com login $GITHUB_API_TOKEN" >> ~/.netrc
        - bundle exec fastlane beta
      if: branch =~ /^release\/.*$/
